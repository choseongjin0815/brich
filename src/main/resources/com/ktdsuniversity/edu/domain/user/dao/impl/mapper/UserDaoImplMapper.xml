<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ktdsuniversity.edu.domain.user.dao.impl.UserDaoImpl">
    <select parameterType="com.ktdsuniversity.edu.domain.user.vo.request.RequestUserLoginVO"
            resultType="com.ktdsuniversity.edu.domain.user.vo.UserVO"
            id="selectUserByLogIdAndPwd">
        SELECT USR_ID
             , LOG_ID
             , EML
             , PSWRD
             , NM
             , SALT
             , LGN_PL_CNT
             , BLCK_YN
             , RCNT_LGN_BLCK_DT
             , RCNT_LGN_FL_DT
             , RCNT_LGN_SCS_DT
             , AUTR
             , SBSCRPTN_EXPRS_DT
             , PNLT_CNT
             , RCNT_BLG_CRTFCTN_DT
             , BLG_ADDRS
             , CRTFD_ADMIN
             , TTL_VSTR_CNT
             , AVRG_VSTR_CNT
             , BLG_NGHBR_CNT
             , SCRP_CNT
             , CRT_DT
             , CRTR
             , UPDT_DT
             , MTTR
             , DLT_YN
         FROM USR
        WHERE LOG_ID = #{logId}
          AND PSWRD = #{pswrd}
    </select>
    <insert parameterType="com.ktdsuniversity.edu.domain.user.vo.request.RequestUserRegistVO"
            id="insertNewUser">
        <selectKey keyProperty="usrId" order="BEFORE" resultType="string">
         SELECT 'USR-' || TO_CHAR(SYSDATE, 'YYYYMMDD-') || LPAD(SEQ_USR_PK.NEXTVAL, 6, 0)
           FROM DUAL
      </selectKey>
        INSERT INTO USR 
        (USR_ID
        , LOG_ID
        , EML
        , PSWRD
        , NM
        , SALT
        , AUTR
        , CRT_DT
        , CRTR
        , UPDT_DT
        , MTTR
        )
        VALUES 
        ( #{usrId}
        , #{logId}
        , #{eml}
        , #{pswrd}
        , #{nm}
        , 'asdasdsadsadsa'
        , #{autr}
        , SYSDATE
        , #{usrId}
        , SYSDATE
        , #{usrId}
        )
    </insert>
    
</mapper>